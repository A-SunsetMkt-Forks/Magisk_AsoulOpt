优化程序性能，支持多线程操作